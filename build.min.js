$(function(){var e=new Editor,t=new StatutsBar;e.show("body"),e.setFont({family:"Arial",fontStyle:"常规",fsize:"16"}),t.init({row:1,col:1})});var menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("新建(N) menu clicked!")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("打开(O) menu clicked!")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("保存(S) menu clicked!")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("另存为(A) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("页面设置(U) menu clicked!")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("打印(P) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("退出(X) menu clicked!")}}],width:"202px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){console.log("撤销(U) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("剪切(X) menu clicked!")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){console.log("复制(C) menu clicked!")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){console.log("粘贴(P) menu clicked!")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){console.log("删除(L) menu clicked!")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){console.log("使用 Bing 搜索 menu clicked!")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){console.log("查找(F) menu clicked!")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){console.log("查找下一个(N) menu clicked!")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){console.log("替换(R) menu clicked!")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){$dlgGoto.show()}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){console.log("全选(A) menu clicked!")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){console.log("时间/日期(D) menu clicked!")}}],width:"218px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){console.log("自动换行(W) menu clicked!")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:function(){$dlgFont.show()}}],width:"156px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){console.log("状态栏(S) menu clicked!")}}],width:"138px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){console.log("查看帮助(H) menu clicked!")}},{title:"关于记事本(A)",shortcut:"",enabled:!0,handler:function(){console.log("关于记事本(A) menu clicked!")}}],width:"166px"}],$menubar=new MenuBar;$menubar.init(menuData);var $dlgFont=function(){var i=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn" title="关闭">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p><div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div></div><div class="font-style"><p>字形(Y):</p><div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div></div><div class="font-size"><p>大小(S):</p><div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div></div><fieldset class="sample"><legend>示例</legend><p class="sample-txt">AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),s={font:"Arial",style:"常规",size:"16",selectf:2,selects:0,selectz:6},o=i.find(".notepad-dlg-titlebar"),a=i.find(".close-btn"),c=i.find(".btn-cancel"),d=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],r=["常规","斜体","粗体","粗斜体"],u=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],f=i.find(".font-family"),h=i.find(".font-style"),p=i.find(".font-size ");function b(){i.remove()}function m(){var e=f.find(".editor").val(),t=h.find(".editor").val(),l=p.find(".editor").val(),n=i.find(".sample p");n.css({"font-family":e,"font-size":l+"px"}),"斜体"==t&&n.css("font-style","italic"),"粗体"==t&&n.css("font-weight","bold"),"粗斜体"==t&&n.css({"font-style":"italic","font-weight":"bold"})}function v(e,t,l){"family"==l&&($(e.find(".item")[s.selectf]).removeClass("selected"),$(e.find(".item")[t]).addClass("selected"),s.selectf=t,e.find(".editor").val(d[t])),"style"==l&&($(e.find(".item")[s.selects]).removeClass("selected"),$(e.find(".item")[t]).addClass("selected"),s.selects=t,e.find(".editor").val(r[t])),"size"==l&&($(e.find(".item")[s.selectz]).removeClass("selected"),$(e.find(".item")[t]).addClass("selected"),s.selectz=t,e.find(".editor").val(u[t])),m()}function g(e,t,l){if("family"==l)for(var n=0;n<e.length;++n){(i=$('<li class="item"></li>')).css("font-family",e[n]),i.html(e[n]),i.click(v.bind(this,t,n,l)),t.find(".list").append(i)}if("style"==l)for(n=0;n<e.length;++n){var i=$('<li class="item"></li>');"斜体"==e[n]&&i.css("font-style","italic"),"粗体"==e[n]&&i.css("font-weight","bold"),"粗斜体"==e[n]&&i.css({"font-style":"italic","font-weight":"bold"}),i.html(e[n]),i.click(v.bind(this,t,n,l)),t.find(".list").append(i)}if("size"==l)for(n=0;n<e.length;++n){(i=$('<li class="item"></li>')).html(e[n]),i.click(v.bind(this,t,n,l)),t.find(".list").append(i)}}return{show:function(e){var t,l,n;$.extend(s,e),i.find(".dialogbox").draggable({handle:o}),a.click(b),c.click(b),g(d,f,"family"),g(r,h,"style"),g(u,p,"size"),t=$(f.find(".item")[s.selectf]),l=$(h.find(".item")[s.selects]),n=$(p.find(".item")[s.selectz]),f.find(".editor").val(t.html()),h.find(".editor").val(l.html()),p.find(".editor").val(n.html()),t.addClass("selected"),l.addClass("selected"),n.addClass("selected"),m(),$("body").append(i)}}}(),$dlgGoto=function(){var t=$('<div class="notepad-dlg-goto"><div class="dialogbox"><div class="titlebar"><p class="title">转到指定行</p><span class="close-btn">✖</span></div><div class="main"><label for="">行号(L)</label><br><input class="txt-line-num" autofocus type="text"><br><input class="btn-goto" type="button" value="转到"><input class="btn-cancel" type="button" value="取消"></div></div></div>'),l=t.find(".titlebar"),n=t.find(".btn-cancel"),i=t.find(".close-btn"),s={linenum:0,totalline:0,container:"body"};function o(){t.remove()}return{show:function(e){$.extend(s,e),t.find(".txt-line-num").val(s.linenum),t.find(".dialogbox").draggable({handle:l}),t.appendTo($(s.container)),n.click(o),i.click(o)}}}();function Editor(){var t=$('<div class="notepad-editor"><textarea spellcheck="false" auto-size="none" wrap="off"></textarea></div>'),l=t.find("textarea");this.setFont=function(e){l.css({"font-family":e.family,"font-size":e.fsize+"pt"}),"斜体"!==e.style?"粗体"!==e.style?"粗偏斜体"!==e.style||l.css({"font-weight":"bold","font-style":"italic"}):l.css({"font-weight":"bold"}):l.css({"font-style":"italic"})},this.show=function(e){$(e).append(t)}}function MenuBar(){var r=$('<div class="notepad-menubar"></div>'),u=[],f=-1;function h(e,t){t.stopPropagation(),f=-1===f?(u[e].css({display:"inline-block"}),e):f!==e?(u[f].css({display:"none"}),u[e].css({display:"inline-block"}),e):(u[f].css({display:"none"}),-1)}function p(e){-1!==f&&(u[f].css({display:"none"}),u[e].css({display:"inline-block"}),f=e)}return{init:function(e){for(var t=$('<ul class="menu-title"></ul>'),l=0;l<e.length;l++){var n=$('<li class="title"></li>');n.html(e[l].title),n.appendTo(t),n.click(h.bind(this,l)),n.mouseover(p.bind(this,l))}for(r.append(t),l=0;l<e.length;++l){for(var i=$('<ul class="menus"></ul>'),s=e[l].menuItems,o=0;o<s.length;++o)if("hr"!==s[o].title){var a=$('<li class="menu-item"></li>');if(a.html(s[o].title),""!=s[o].shortcut){var c=$('<span class="shortcut"></span>');c.html(s[o].shortcut),a.append(c)}s[o].handler,a.bind("click",{handle:s[o].handler},function(e){-1!==f&&(u[f].css({display:"none"}),f=-1),e.data.handle()}),i.append(a)}else{var d=$('<li class="menu-hr"></li>');i.append(d)}i.css({width:e[l].width,left:54*l+"px",display:"none"}),r.append(i),u.push(i)}$("body").append(r)}}}function StatutsBar(){var t=$('<div class="notepad-statusbar"><div class="left-panel"></div><div class="right-panel"><p class="line"></p></div></div>'),l=t.find(".line"),n={row:1,col:1};function i(e,t){l.html("第&nbsp;"+e+"&nbsp;行，第&nbsp;"+t+"&nbsp;列")}return{init:function(e){$.extend(n,e),i(n.row,n.col),$("body").append(t)},setLine:i,isShow:function(e){e?t.css("display","block"):t.css("display","none")}}}